---
title: "Diversity at the University of Basel"
description: Diversity at the University of Basel (2000-2020)
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)
library(ggtext)
library(patchwork)

pub_data <- read_csv("1_data/unibas_diversity.csv")
```

## Background

## Methods 

## Gender Diversity

```{r, echo=FALSE, eval=TRUE, fig.width = 10, fig.height= 10}
gender_inst_time <- pub_data %>% 
  select(year, gender_proportion, `Org-Swiss Tropical and Public Health Institute`: `Org-Basel Institute on Governance`) %>%
  pivot_longer(!year:gender_proportion,names_to = "organisation_name", values_to = "applies") %>% 
  filter(applies == 1) %>% #only select those rows that could be classified
  mutate(organisation_name = case_when(organisation_name == "Org-Faculty of Theology" ~ "Faculty of\nTheology",
                                       organisation_name == "Org-Faculty of Science" ~ "Faculty of\nScience",
                                       organisation_name == "Org-Faculty of Law" ~ "Faculty of\nLaw",
                                       organisation_name == "Org-Faculty of Humanties and Social Sciences" ~ "Faculty of\nHumanties & Soc. Sci.",
                                       organisation_name == "Org-Faculty of Medicine"  ~ "Faculty of\nMedicine",
                                       organisation_name == "Org-Faculty of Business and Economics" ~ "Faculty of\nBusiness & Econ.",
                                       organisation_name == "Org-Faculty of Psychology" ~ "Faculty of\nPsychology")) %>% 
  filter(!is.na(organisation_name)) %>% # ignoring non-faculty organizations
  group_by(organisation_name, year) %>% 
  summarise(FEMALE = 100*mean(gender_proportion, na.rm = TRUE),
            MALE = 100 - FEMALE) %>%
  pivot_longer(FEMALE:MALE, names_to = "gender", values_to = "publication")

gender_inst_time$gender = factor(gender_inst_time$gender,levels = c("MALE","FEMALE"))


# Plot

charcoal <-  "#31424B"

label_num <- data.frame(organisation_name= unique(gender_inst_time$organisation_name), label= c("50%", rep("", 6)))
label_f <- data.frame(organisation_name= unique(gender_inst_time$organisation_name), label= c("FEMALE", rep("", 6)))
label_m <- data.frame(organisation_name= unique(gender_inst_time$organisation_name), label= c("MALE", rep("", 6)))

pA1 <- ggplot(gender_inst_time, aes(x= year, y=publication, fill=gender)) +
  geom_bar(width = 1,position = "stack", stat = "identity") +
  scale_fill_manual(values = c("FEMALE" = "#4ADABF", "MALE" = "#4E4BD8"))+
  geom_hline(yintercept = 50, linetype = "dashed", color = "white") +
  theme_void() +
  geom_label(data = label_num, aes(label=label), fill = NA,
             x = 2001, y = 51, hjust= 0, vjust = 0,  label.size = NA,
             family = "Oswald Bold", size = 5, color = "white" ,
             inherit.aes = FALSE) +
  geom_label(data = label_f, aes(label=label), fill = NA,
             y = 5, x = 2010, hjust=0.5,  label.size = NA,
             family = "Oswald Bold", size = 5, color = "white" ,
             inherit.aes = FALSE) +
  geom_label(data = label_m, aes(label=label), fill = NA,
             y = 95, x = 2010, hjust=0.5,  label.size = NA,
             family = "Oswald Bold", size = 5, color = "white" ,
             inherit.aes = FALSE) +
  scale_x_continuous(breaks = c(2000, 2020)) +
  scale_y_continuous(expand = c(0.01,0), breaks = c(0, 100)) +
  facet_wrap(.~ toupper(organisation_name), nrow = 1) +
  labs(title = "PERCENTAGE OF FEMALE AUTHORS", subtitle = "OVER TIME BY FACULTY: ALL AUTHORSHIPS COMBINED", x = "YEAR", y = "PERC.") +
  theme(legend.position = "none",
        axis.text.x = element_text(family = "Oswald", size = 9, colour = "grey60"),
        axis.text.y = element_text(family = "Oswald", size = 9, colour = "grey60"),
        panel.spacing = unit(1, "lines"),
        strip.text = element_text(family = "Oswald Bold", size = 11.5, colour = charcoal),
        axis.title.x = element_text(family = "Oswald Bold", size = 10, colour = "grey60"),
        axis.title.y = element_text(family = "Oswald Bold", size = 10, colour = "grey60", angle = 90),
        plot.title = element_text(face = "bold", family = "Oswald", hjust = 0, margin = margin(t = 15,b = 25), size = 20, color = charcoal),
        plot.subtitle = element_text(family = "Oswald", hjust = 0.008, margin = margin(b = 10), size = 17, color = charcoal),
        plot.caption =element_text(family = "Oswald ExtraLight", face = "italic", size = 6.5, hjust = 1, margin = margin(t = 5)))



# OVER TIME FEMALE 1ST and LAST AUTHOR BY FACULTY ----------------------------------------------------------------

# data
author_first <- pub_data %>% 
  filter(n_authors > 1) %>% 
  select(year, gender_first, `Org-Swiss Tropical and Public Health Institute`: `Org-Basel Institute on Governance`) %>%
  pivot_longer(!year:gender_first,names_to = "organisation_name", values_to = "applies") %>% 
  filter(applies == 1) %>% #only select those rows that could be classified
  mutate(organisation_name = case_when(organisation_name == "Org-Faculty of Theology" ~ "Faculty of\nTheology",
                                       organisation_name == "Org-Faculty of Science" ~ "Faculty of\nScience",
                                       organisation_name == "Org-Faculty of Law" ~ "Faculty of\nLaw",
                                       organisation_name == "Org-Faculty of Humanties and Social Sciences" ~ "Faculty of\nHumanties & Soc. Sci.",
                                       organisation_name == "Org-Faculty of Medicine"  ~ "Faculty of\nMedicine",
                                       organisation_name == "Org-Faculty of Business and Economics" ~ "Faculty of\nBusiness & Econ.",
                                       organisation_name == "Org-Faculty of Psychology" ~ "Faculty of\nPsychology")) %>% 
  filter(!is.na(organisation_name)) %>% # ignoring non-faculty organizations
  group_by(organisation_name, year) %>% 
  summarise(mean_f = 100*mean(gender_first, na.rm = TRUE))  %>% 
  mutate(author_type = "FIRST AUTHOR") 



author_last <- pub_data %>% 
  filter(n_authors > 1) %>% 
  select(year, gender_last, `Org-Swiss Tropical and Public Health Institute`: `Org-Basel Institute on Governance`) %>%
  pivot_longer(!year:gender_last,names_to = "organisation_name", values_to = "applies") %>% 
  filter(applies == 1) %>% #only select those rows that could be classified
  mutate(organisation_name = case_when(organisation_name == "Org-Faculty of Theology" ~ "Faculty of\nTheology",
                                       organisation_name == "Org-Faculty of Science" ~ "Faculty of\nScience",
                                       organisation_name == "Org-Faculty of Law" ~ "Faculty of\nLaw",
                                       organisation_name == "Org-Faculty of Humanties and Social Sciences" ~ "Faculty of\nHumanties & Soc. Sci.",
                                       organisation_name == "Org-Faculty of Medicine"  ~ "Faculty of\nMedicine",
                                       organisation_name == "Org-Faculty of Business and Economics" ~ "Faculty of\nBusiness & Econ.",
                                       organisation_name == "Org-Faculty of Psychology" ~ "Faculty of\nPsychology")) %>% 
  filter(!is.na(organisation_name)) %>% # ignoring non-faculty organizations
  group_by(organisation_name, year) %>% 
  summarise(mean_f = 100*mean(gender_last, na.rm = TRUE))  %>% 
  mutate(author_type = "LAST AUTHOR") 

author_dat <- bind_rows(author_first, author_last) 


label_num <- data.frame(organisation_name= unique(author_dat$organisation_name), label= c("50%", rep("", 6)))
label_f <- data.frame(organisation_name= unique(author_dat$organisation_name), label= c("FIRST AUTHOR", rep("", 6)))
label_m <- data.frame(organisation_name= unique(author_dat$organisation_name), label= c("LAST AUTHOR", rep("", 6)))




# plot



charcoal <-  "#31424B"
col_pal <- c("#4ADABF", "white")

pA2 <- author_dat %>% 
  ggplot(aes(x = year, y = mean_f, color = author_type ))+ 
  geom_line(size = 1.2 ) +
  geom_point(size = 2)+
  theme_void() +
  geom_label(data = label_num, aes(label=label), fill = NA,
             x = 2001, y = 51, hjust= 0, vjust = 0,  label.size = NA,
             family = "Oswald Bold", size = 5, color = "white" ,
             inherit.aes = FALSE) +
  geom_label(data = label_f, aes(label=label), fill = NA,
             y = 95, x = 2001, hjust= 0, vjust = 1,  label.size = NA,
             family = "Oswald Bold", size = 5, color = "#4ADABF" ,
             inherit.aes = FALSE) +
  geom_label(data = label_m, aes(label=label), fill = NA,
             y = 89, x = 2001, hjust= 0, vjust = 1,  label.size = NA,
             family = "Oswald Bold", size = 5, color = "white" ,
             inherit.aes = FALSE) +
  facet_wrap(toupper(organisation_name)~., nrow = 1)+
  scale_color_manual(values = col_pal) +
  geom_hline(yintercept = 50, linetype = "dashed", color = "white") +
  scale_x_continuous(breaks = c(2000, 2020)) +
  scale_y_continuous(expand = c(0.01,0), breaks = c(0, 100)) +
  labs(title = "OVER TIME BY FACULTY: FIRST VERSUS LAST AUTHOR" , x = "YEAR", y = "PERC.",
       caption = "Data from the UNIBAS publication database.") +
  theme(legend.position = "none",
        axis.text.x = element_text(family = "Oswald", size = 10, colour = "grey60"),
        axis.text.y = element_text(family = "Oswald", size = 10, colour = "grey60",  margin = margin(l = 5, r = 5)),
        axis.title.x = element_text(family = "Oswald Bold", size = 10, colour = "grey60"),
        axis.title.y = element_text(family = "Oswald Bold", size = 10, colour = "grey60", angle = 90),
        panel.spacing = unit(2, "lines"),
        panel.background = element_rect(fill = "#4E4BD8"),
        plot.margin = unit(c(0,0.5,0,0), "cm"),
        strip.text.x = element_text(family = "Oswald Bold", size = 12, colour = charcoal, margin = margin(b = 3)),
        panel.border  = element_rect(colour = charcoal, fill = "NA", size = 0.75, linetype = "solid"),
        plot.title = element_text(family = "Oswald", hjust = 0, margin = margin(b = 10, t = 30),colour = charcoal, size = 17),
        plot.caption =element_text(family = "Oswald ExtraLight", face = "italic", size = 6.5, hjust = 1, margin = margin(t = 5)))



pA <- pA1/pA2

pA

``` 

Women are systematically underrepresented in academia. Whilst this inequality varies across academic departments, there has been an general upward trend in the proportion of female authors from the University of Basel over the last two decades, starting at X in 2000 and reaching Y in 2020. This trend is also reflected in the percentage of first and last female authors. In this section, we offer a by-faculty insight into these developments over time. In particular, the prize for most improved goes to the Faculties of Humanities and Social Sciences, with Psychology and Medicine as runners up. These improvements are less noticeable in the Faculties of Science, Law, and Business & Economics, and the trend is reversed for the Faculty of Theology. However, this latter case may not be so informative as the sample of publications is considerably smaller. 

## Nationality

```{r}

```

## Limitations and Outlook


## Conclusion


## References 



